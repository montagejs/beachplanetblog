function getChildren(e){return e.children}function getParent(e){return e.parent}function getSiblings(e){var i=getParent(e);return i?getChildren(i):[e]}function getAttributeValue(e,i){return e.attribs&&e.attribs[i]}function hasAttrib(e,i){return hasOwnProperty.call(e.attribs,i)}function getName(e){return e.name}function find(e,i,t,s){for(var a,u=[],n=0,r=i.length;r>n&&!(e(i[n])&&(u.push(i[n]),0>=--s))&&(a=getChildren(i[n]),!(t&&a&&a.length>0&&(a=find(e,a,t,s),u=u.concat(a),s-=a.length,0>=s)));n++);return u}function findOneChild(e,i){for(var t=0,s=i.length;s>t;t++)if(e(i[t]))return i[t];return null}function findOne(e,i){for(var t=null,s=0,a=i.length;a>s&&!t;s++)e(i[s])?t=i[s]:i[s].children&&i[s].children.length>0&&(t=findOne(e,i[s].children));return t}function findAll(e,i){for(var t=[],s=0,a=i.length;a>s;s++){e(i[s])&&t.push(i[s]);var u=getChildren(i[s]);u&&u.length&&(t=t.concat(findAll(e,u)))}return t}function filter(e,i,t,s){return Array.isArray(i)||(i=[i]),"number"==typeof s&&isFinite(s)?1===s?(i=t===!1?findOneChild(e,i):findOne(e,i),i?[i]:[]):find(e,i,t!==!1,s):t===!1?i.filter(e):findAll(e,i)}function getAttribCheck(e,i){return"function"==typeof i?function(t){return t.attribs&&i(t.attribs[e])}:function(t){return t.attribs&&t.attribs[e]===i}}var ElementType=require("domelementtype"),DomUtils=module.exports,isTag=DomUtils.isTag=ElementType.isTag;DomUtils.getChildren=getChildren,DomUtils.getParent=getParent,DomUtils.getAttributeValue=getAttributeValue,DomUtils.hasAttrib=hasAttrib,DomUtils.getName=getName,DomUtils.getSiblings=getSiblings,DomUtils.findOne=findOne,DomUtils.findAll=findAll,DomUtils.filter=filter,DomUtils.testElement=function(e,i){for(var t in e)if(e.hasOwnProperty(t)){if("tag_name"===t){if(!isTag(i)||!e.tag_name(i.name))return!1}else if("tag_type"===t){if(!e.tag_type(i.type))return!1}else if("tag_contains"===t){if(isTag(i)||!e.tag_contains(i.data))return!1}else if(!i.attribs||!e[t](i.attribs[t]))return!1}else;return!0};var Checks={tag_name:function(e){return"function"==typeof e?function(i){return isTag(i)&&e(i.name)}:"*"===e?isTag:function(i){return isTag(i)&&i.name===e}},tag_type:function(e){return"function"==typeof e?function(i){return e(i.type)}:function(i){return i.type===e}},tag_contains:function(e){return"function"==typeof type?function(i){return!isTag(i)&&e(i.data)}:function(i){return!isTag(i)&&i.data===e}}};DomUtils.getElements=function(e,i,t,s){var a=[];for(var u in e)e.hasOwnProperty(u)&&(u in Checks?a.push(Checks[u](e[u])):a.push(getAttribCheck(u,e[u])));return 0===a.length?[]:1===a.length?filter(a[0],i,t,s):filter(function(e){return a.some(function(i){return i(e)})},i,t,s)},DomUtils.getElementById=function(e,i,t){return Array.isArray(i)||(i=[i]),findOne(getAttribCheck("id",e),i,t!==!1)},DomUtils.getElementsByTagName=function(e,i,t,s){return filter(Checks.tag_name(e),i,t,s)},DomUtils.getElementsByTagType=function(e,i,t,s){return filter(Checks.tag_type(e),i,t,s)},DomUtils.removeElement=function(e){if(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.parent){var i=e.parent.children;i.splice(i.lastIndexOf(e),1)}},DomUtils.replaceElement=function(e,i){if(e.prev&&(e.prev.next=i,i.prev=e.prev),e.next&&(e.next.prev=i,i.next=e.next),e.parent){var t=e.parent.children;t.splice(t.lastIndexOf(e),1,i),i.parent=e.parent}},DomUtils.getInnerHTML=function(e){if(!e.children)return"";for(var i=e.children,t=i.length,s="",a=0;t>a;a++)s+=DomUtils.getOuterHTML(i[a]);return s};var booleanAttribs={__proto__:null,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,defer:!0,disabled:!0,hidden:!0,loop:!0,multiple:!0,open:!0,readonly:!0,required:!0,scoped:!0,selected:!0,"/":!0},emptyTags={__proto__:null,area:!0,base:!0,basefont:!0,br:!0,col:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,link:!0,meta:!0,param:!0,embed:!0};DomUtils.getOuterHTML=function(e){var i=e.type;if(i===ElementType.Text)return e.data;if(i===ElementType.Comment)return"<!--"+e.data+"-->";if(i===ElementType.Directive)return"<"+e.data+">";if(i===ElementType.CDATA)return"<!CDATA "+DomUtils.getInnerHTML(e)+"]]>";var t="<"+e.name;if("attribs"in e)for(var s in e.attribs)if(e.attribs.hasOwnProperty(s)){t+=" "+s;var a=e.attribs[s];a?t+='="'+a+'"':s in booleanAttribs||(t+='=""')}return e.name in emptyTags&&0===e.children.length?t+" />":t+">"+DomUtils.getInnerHTML(e)+"</"+e.name+">"},DomUtils.getText=function getText(e){return Array.isArray(e)?e.map(getText).join(""):isTag(e)||e.type===ElementType.CDATA?getText(e.children):e.type===ElementType.Text?e.data:""};