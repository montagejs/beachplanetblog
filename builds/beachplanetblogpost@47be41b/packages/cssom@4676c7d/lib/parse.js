var CSSOM={};CSSOM.parse=function(e){for(var t,n,i,r,a,s,o,l,c,u,h=0,d="before-selector",p="",m={selector:!0,value:!0,atRule:!0,"importRule-begin":!0,importRule:!0,atBlock:!0,"documentRule-begin":!0},f=new CSSOM.CSSStyleSheet,g=f,v="",_=/@(-(?:\w+-)+)?keyframes/g,y=function(t){var n=e.substring(0,h).split("\n"),i=n.length,r=n.pop().length+1,a=Error(t+" (line "+i+", char "+r+")");throw a.line=i,a.char=r,a.styleSheet=f,a};u=e.charAt(h);h++)switch(u){case" ":case"	":case"\r":case"\n":case"\f":m[d]&&(p+=u);break;case'"':t=h+1;do t=e.indexOf('"',t)+1,t||y('Unmatched "');while("\\"===e[t-2]);switch(p+=e.slice(h,t),h=t-1,d){case"before-value":d="value";break;case"importRule-begin":d="importRule"}break;case"'":t=h+1;do t=e.indexOf("'",t)+1,t||y("Unmatched '");while("\\"===e[t-2]);switch(p+=e.slice(h,t),h=t-1,d){case"before-value":d="value";break;case"importRule-begin":d="importRule"}break;case"/":"*"===e.charAt(h+1)?(h+=2,t=e.indexOf("*/",h),-1===t?y("Missing */"):h=t+1):p+=u,"importRule-begin"===d&&(p+=" ",d="importRule");break;case"@":if(e.indexOf("@-moz-document",h)===h){d="documentRule-begin",c=new CSSOM.CSSDocumentRule,c.__starts=h,h+="-moz-document".length,p="";break}if(e.indexOf("@media",h)===h){d="atBlock",a=new CSSOM.CSSMediaRule,a.__starts=h,h+="media".length,p="";break}if(e.indexOf("@import",h)===h){d="importRule-begin",h+="import".length,p+="@import";break}if(e.indexOf("@font-face",h)===h){d="fontFaceRule-begin",h+="font-face".length,o=new CSSOM.CSSFontFaceRule,o.__starts=h,p="";break}_.lastIndex=h;var b=_.exec(e);if(b&&b.index===h){d="keyframesRule-begin",l=new CSSOM.CSSKeyframesRule,l.__starts=h,l._vendorPrefix=b[1],h+=b[0].length-1,p="";break}"selector"==d&&(d="atRule"),p+=u;break;case"{":"selector"===d||"atRule"===d?(r.selectorText=p.trim(),r.style.__starts=h,p="",d="before-name"):"atBlock"===d?(a.media.mediaText=p.trim(),g=n=a,a.parentStyleSheet=f,p="",d="before-selector"):"fontFaceRule-begin"===d?(n&&(o.parentRule=n),o.parentStyleSheet=f,r=o,p="",d="before-name"):"keyframesRule-begin"===d?(l.name=p.trim(),n&&(l.parentRule=n),l.parentStyleSheet=f,g=n=l,p="",d="keyframeRule-begin"):"keyframeRule-begin"===d?(r=new CSSOM.CSSKeyframeRule,r.keyText=p.trim(),r.__starts=h,p="",d="before-name"):"documentRule-begin"===d&&(c.matcher.matcherText=p.trim(),n&&(c.parentRule=n),g=n=c,c.parentStyleSheet=f,p="",d="before-selector");break;case":":"name"===d?(i=p.trim(),p="",d="before-value"):p+=u;break;case"(":if("value"===d)if("expression"==p.trim()){var C=new CSSOM.CSSValueExpression(e,h).parse();C.error?y(C.error):(p+=C.expression,h=C.idx)}else t=e.indexOf(")",h+1),-1===t&&y('Unmatched "("'),p+=e.slice(h,t+1),h=t;else p+=u;break;case"!":"value"===d&&e.indexOf("!important",h)===h?(v="important",h+="important".length):p+=u;break;case";":switch(d){case"value":r.style.setProperty(i,p.trim(),v),v="",p="",d="before-name";break;case"atRule":p="",d="before-selector";break;case"importRule":s=new CSSOM.CSSImportRule,s.parentStyleSheet=s.styleSheet.parentStyleSheet=f,s.cssText=p+u,f.cssRules.push(s),p="",d="before-selector";break;default:p+=u}break;case"}":switch(d){case"value":r.style.setProperty(i,p.trim(),v),v="";case"before-name":case"name":r.__ends=h+1,n&&(r.parentRule=n),r.parentStyleSheet=f,g.cssRules.push(r),p="",d=g.constructor===CSSOM.CSSKeyframesRule?"keyframeRule-begin":"before-selector";break;case"keyframeRule-begin":case"before-selector":case"selector":n||y("Unexpected }"),g.__ends=h+1,f.cssRules.push(g),g=f,n=null,p="",d="before-selector"}break;default:switch(d){case"before-selector":d="selector",r=new CSSOM.CSSStyleRule,r.__starts=h;break;case"before-name":d="name";break;case"before-value":d="value";break;case"importRule-begin":d="importRule"}p+=u}return f},exports.parse=CSSOM.parse,CSSOM.CSSStyleSheet=require("./CSSStyleSheet").CSSStyleSheet,CSSOM.CSSStyleRule=require("./CSSStyleRule").CSSStyleRule,CSSOM.CSSImportRule=require("./CSSImportRule").CSSImportRule,CSSOM.CSSMediaRule=require("./CSSMediaRule").CSSMediaRule,CSSOM.CSSFontFaceRule=require("./CSSFontFaceRule").CSSFontFaceRule,CSSOM.CSSStyleDeclaration=require("./CSSStyleDeclaration").CSSStyleDeclaration,CSSOM.CSSKeyframeRule=require("./CSSKeyframeRule").CSSKeyframeRule,CSSOM.CSSKeyframesRule=require("./CSSKeyframesRule").CSSKeyframesRule,CSSOM.CSSValueExpression=require("./CSSValueExpression").CSSValueExpression,CSSOM.CSSDocumentRule=require("./CSSDocumentRule").CSSDocumentRule;