(function(){"use strict";function e(e,n,i){if(e&&"object"==typeof e&&e.href)return e;if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o={},l=e;l=l.trim();var c=s.exec(l);if(c){c=c[0];var b=c.toLowerCase();o.protocol=b,l=l.substr(c.length)}if(i||c||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var C="//"===l.substr(0,2);!C||c&&v[c]||(l=l.substr(2),o.slashes=!0)}if(!v[c]&&(C||c&&!_[c])){var w=l.indexOf("@");if(-1!==w){for(var L=l.slice(0,w),x=!0,S=0,M=d.length;M>S;S++)if(-1!==L.indexOf(d[S])){x=!1;break}x&&(o.auth=decodeURIComponent(L),l=l.substr(w+1))}for(var E=-1,S=0,M=h.length;M>S;S++){var T=l.indexOf(h[S]);-1!==T&&(0>E||E>T)&&(E=T)}-1!==E?(o.host=l.substr(0,E),l=l.substr(E)):(o.host=l,l="");for(var D=r(o.host),O=Object.keys(D),S=0,M=O.length;M>S;S++){var P=O[S];o[P]=D[P]}o.hostname=o.hostname||"";var A="["===o.hostname[0]&&"]"===o.hostname[o.hostname.length-1];if(o.hostname.length>p)o.hostname="";else if(!A)for(var z=o.hostname.split(/\./),S=0,M=z.length;M>S;S++){var R=z[S];if(R&&!R.match(m)){for(var I="",B=0,N=R.length;N>B;B++)I+=R.charCodeAt(B)>127?"x":R[B];if(!I.match(m)){var F=z.slice(0,S),k=z.slice(S+1),j=R.match(f);j&&(F.push(j[1]),k.unshift(j[2])),k.length&&(l="/"+k.join(".")+l),o.hostname=F.join(".");break}}}if(o.hostname=o.hostname.toLowerCase(),!A){for(var V=o.hostname.split("."),q=[],S=0;V.length>S;++S){var G=V[S];q.push(G.match(/[^A-Za-z0-9_-]/)?"xn--"+a.encode(G):G)}o.hostname=q.join(".")}o.host=(o.hostname||"")+(o.port?":"+o.port:""),o.href+=o.host,A&&(o.hostname=o.hostname.substr(1,o.hostname.length-2),"/"!==l[0]&&(l="/"+l))}if(!g[b])for(var S=0,M=u.length;M>S;S++){var U=u[S],W=encodeURIComponent(U);W===U&&(W=escape(U)),l=l.split(U).join(W)}var H=l.indexOf("#");-1!==H&&(o.hash=l.substr(H),l=l.slice(0,H));var Y=l.indexOf("?");return-1!==Y?(o.search=l.substr(Y),o.query=l.substr(Y+1),n&&(o.query=y.parse(o.query)),l=l.slice(0,Y)):n&&(o.search="",o.query={}),l&&(o.pathname=l),_[c]&&o.hostname&&!o.pathname&&(o.pathname="/"),(o.pathname||o.search)&&(o.path=(o.pathname?o.pathname:"")+(o.search?o.search:"")),o.href=t(o),o}function t(t){"string"==typeof t&&(t=e(t));var n=t.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var i=t.protocol||"",r=t.pathname||"",a=t.hash||"",s=!1,o="";void 0!==t.host?s=n+t.host:void 0!==t.hostname&&(s=n+(-1===t.hostname.indexOf(":")?t.hostname:"["+t.hostname+"]"),t.port&&(s+=":"+t.port)),t.query&&"object"==typeof t.query&&Object.keys(t.query).length&&(o=y.stringify(t.query));var l=t.search||o&&"?"+o||"";return i&&":"!==i.substr(-1)&&(i+=":"),t.slashes||(!i||_[i])&&s!==!1?(s="//"+(s||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):s||(s=""),a&&"#"!==a.charAt(0)&&(a="#"+a),l&&"?"!==l.charAt(0)&&(l="?"+l),i+s+r+l+a}function n(e,n){return t(i(e,n))}function i(n,i){if(!n)return i;if(n=e(t(n),!1,!0),i=e(t(i),!1,!0),n.hash=i.hash,""===i.href)return n.href=t(n),n;if(i.slashes&&!i.protocol)return i.protocol=n.protocol,_[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=t(i),i;if(i.protocol&&i.protocol!==n.protocol){if(!_[i.protocol])return i.href=t(i),i;if(n.protocol=i.protocol,!i.host&&!v[i.protocol]){for(var r=(i.pathname||"").split("/");r.length&&!(i.host=r.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),""!==r[0]&&r.unshift(""),2>r.length&&r.unshift(""),i.pathname=r.join("/")}return n.pathname=i.pathname,n.search=i.search,n.query=i.query,n.host=i.host||"",n.auth=i.auth,n.hostname=i.hostname||i.host,n.port=i.port,(void 0!==n.pathname||void 0!==n.search)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.slashes=n.slashes||i.slashes,n.href=t(n),n}var a=n.pathname&&"/"===n.pathname.charAt(0),s=void 0!==i.host||i.pathname&&"/"===i.pathname.charAt(0),o=s||a||n.host&&i.pathname,l=o,c=n.pathname&&n.pathname.split("/")||[],r=i.pathname&&i.pathname.split("/")||[],u=n.protocol&&!_[n.protocol];if(u&&(delete n.hostname,delete n.port,n.host&&(""===c[0]?c[0]=n.host:c.unshift(n.host)),delete n.host,i.protocol&&(delete i.hostname,delete i.port,i.host&&(""===r[0]?r[0]=i.host:r.unshift(i.host)),delete i.host),o=o&&(""===r[0]||""===c[0])),s)n.host=i.host||""===i.host?i.host:n.host,n.hostname=i.hostname||""===i.hostname?i.hostname:n.hostname,n.search=i.search,n.query=i.query,c=r;else if(r.length)c||(c=[]),c.pop(),c=c.concat(r),n.search=i.search,n.query=i.query;else if("search"in i){if(u){n.hostname=n.host=c.shift();var h=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;h&&(n.auth=h.shift(),n.host=n.hostname=h.shift())}return n.search=i.search,n.query=i.query,(void 0!==n.pathname||void 0!==n.search)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=t(n),n}if(!c.length)return delete n.pathname,n.search?delete n.path:n.path="/"+n.search,n.href=t(n),n;for(var d=c.slice(-1)[0],p=(n.host||i.host)&&("."===d||".."===d)||""===d,m=0,f=c.length;f>=0;f--)d=c[f],"."==d?c.splice(f,1):".."===d?(c.splice(f,1),m++):m&&(c.splice(f,1),m--);if(!o&&!l)for(;m--;m)c.unshift("..");!o||""===c[0]||c[0]&&"/"===c[0].charAt(0)||c.unshift(""),p&&"/"!==c.join("/").substr(-1)&&c.push("");var g=""===c[0]||c[0]&&"/"===c[0].charAt(0);if(u){n.hostname=n.host=g?"":c.length?c.shift():"";var h=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;h&&(n.auth=h.shift(),n.host=n.hostname=h.shift())}return o=o||n.host&&c.length,o&&!g&&c.unshift(""),n.pathname=c.join("/"),(void 0!==n.pathname||void 0!==n.search)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=i.auth||n.auth,n.slashes=n.slashes||i.slashes,n.href=t(n),n}function r(e){var t={},n=o.exec(e);return n&&(n=n[0],":"!==n&&(t.port=n.substr(1)),e=e.substr(0,e.length-n.length)),e&&(t.hostname=e),t}var a=require("punycode");exports.parse=e,exports.resolve=n,exports.resolveObject=i,exports.format=t;var s=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,l=["<",">",'"',"`"," ","\r","\n","	"],c=["{","}","|","\\","^","~","`"].concat(l),u=["'"].concat(l),h=["%","/","?",";","#"].concat(c).concat(u),d=["/","@","?","#"].concat(l),p=255,m=/^[a-zA-Z0-9][a-z0-9A-Z_-]{0,62}$/,f=/^([a-zA-Z0-9][a-z0-9A-Z_-]{0,62})(.*)$/,g={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=require("querystring")})();