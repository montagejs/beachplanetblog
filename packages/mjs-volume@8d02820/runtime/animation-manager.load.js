montageDefine("8d02820","runtime/animation-manager",{dependencies:["runtime/dependencies/gl-matrix","runtime/base","runtime/animation"],factory:function(e,t){e("runtime/dependencies/gl-matrix");var n=e("runtime/base").Base;e("runtime/animation").KeyframeAnimation,e("runtime/animation").BasicAnimation;var i=e("runtime/animation").Animation;t.AnimationManager=Object.create(n,{startTime:{get:function(){if(this.animations){if(this.animations.length>0){for(var e=this.animations[0].startTime,t=1;this.animations.length>t;t++)e>this.animations[t].startTime&&(e=this.animations[t].startTime);return e}return 0}}},endTime:{get:function(){if(this.animations){if(this.animations.length>0){for(var e=this.animations[0].endTime,t=1;this.animations.length>t;t++)this.animations[t].endTime>e&&(e=this.animations[t].endTime);return e}return-1}}},_animations:{value:null,writable:!0},animations:{get:function(){return this._animations},set:function(e){this._animations!=e&&(this._animations=e)}},_sceneTime:{value:0,writable:!0},sceneTime:{get:function(){return this._sceneTime},set:function(e){this._delegate&&this._delegate.sceneTimeWillChange&&this._delegate.sceneTimeWillChange(this,e),this._sceneTime=e,this._delegate&&this._delegate.sceneTimeDidChange&&this._delegate.sceneTimeDidChange(this)}},_delegate:{value:0,writable:!0},delegate:{get:function(){return this._delegate},set:function(e){this._delegate=e}},targets:{get:function(){var e=[];return null!=this._animations&&this._animations.forEach(function(t){t.type==i.KEYFRAME?t.channels.forEach(function(t){e.push(t.target.id)},this):t.type==i.BASIC},this),e}},hasAnimation:{value:function(e,t){return null==this._animations?!1:(null==t&&(t=this.targets),-1!==t.indexOf(e))}},nodeHasAnimatedAncestor:{value:function(e){do{if(this.hasAnimation(e.id))return!0;e=e.parent}while(null!=e);return!1}},updateTargetsAtTime:{value:function(e,t){this.animations&&this.animations.forEach(function(n){n.type==i.KEYFRAME?n.updateTargetsAtTime(e,t):n.type==i.BASIC},this)}},evaluateAtTime:{value:function(e){this._activeAnimations&&this._activeAnimations.forEach(function(t){t.type==i.KEYFRAME||t.type==i.BASIC&&t._evaluateAtTime(e)},this)}},hasActiveAnimations:{value:function(){return this._activeAnimations.length>0}},_activeAnimations:{value:0,writable:!0},_removeAnimationAtIndex:{value:function(e){var t=this._activeAnimations[e];t.delegate&&t.delegate.animationDidStop(t),this._activeAnimations.splice(e,1)}},playAnimation:{value:function(e){var t=this;this._activeAnimations.push(e),e.delegate&&e.delegate.animationDidStart(e),setTimeout(function(){var n=t._activeAnimations.indexOf(e);-1!==n&&t._removeAnimationAtIndex(n)},e.duration)}},init:{value:function(){return this.__Base_init(),this.animations=[],this._activeAnimations=[],this}},removeAnimationWithTargetAndPath:{value:function(e,t){if(this._activeAnimations)for(var n=0;this._activeAnimations.length>n;n++){var i=this._activeAnimations[n];if(i.target===e&&i.path==t)return this._removeAnimationAtIndex(n),void 0}}}})}});